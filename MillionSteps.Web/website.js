// Generated by IcedCoffeeScript 108.0.9
(function() {
  define(['ajax', 'xhr'], function(ajax, xhr) {
    var website, _xhr;
    _xhr = xhr;
    website = {
      choicesSectionSelector: 'section.choices',
      choicesFormSelector: 'section.choices form',
      handleChoiceResponse: function(response) {
        var fadeInNewChoices, newUrl, timeToWait, timeWaited;
        newUrl = _xhr.fromLastCall.responseURL;
        history.replaceState({}, '', newUrl);
        timeWaited = Date.now() - ajax.startTime;
        timeToWait = Math.max(0, ajax.longFadeTime - timeWaited);
        fadeInNewChoices = function() {
          var newChoices, newChoicesSection;
          newChoicesSection = $(response).find(website.choicesSectionSelector);
          $(website.choicesSectionSelector).replaceWith(newChoicesSection);
          newChoices = $(website.choicesFormSelector);
          newChoices.hide();
          return newChoices.fadeIn(ajax.quickFadeTime);
        };
        return window.setTimeout(fadeInNewChoices, timeToWait);
      },
      handleAjaxError: function() {
        return window.location.replace('/');
      }
    };
    ajax.setupLiveForm(website.choicesFormSelector, website.handleChoiceResponse, website.handleAjaxError);
    return website;
  });

}).call(this);
